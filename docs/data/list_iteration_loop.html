<h1 class="execution"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1" title="Execution Node"><use x="0" y="0" width="1" height="1" href="#execution_icon"/></svg> List Iteration Loop</h1>
<p>
    Iterates through a list.
</p>

<h2>Input Parameters</h2>
<ul>
    <li>
        <span class="input_var"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1"><use x="0" y="0" width="1" height="1" href="#input_icon"/></svg> Iteration List</span> (Generic List) - List to iterate through
    </li>
</ul>

<h2>Output Values</h2>
<ul>
    <li>
        <span class="output_var"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1"><use x="0" y="0" width="1" height="1" href="#output_icon"/></svg> Iteration Value</span> (Generic) - Value of the iterated list entry
    </li>
</ul>

<h2>Usage</h2>
<p>
    Use this node to go through each entry of the list one by one in order.
</p>
<p>
    The execution of the node graph will continue along "Loop Complete" after the loop is completed.
    See <a href="?node=break_loop" class="node execution"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1"><use x="0" y="0" width="1" height="1" href="#execution_icon"/></svg> Break Loop</a> to see how to break the loop.
</p>
<p>
    It may be fine to use this node plainly for very simple tasks with tiny lists.
    However, this node is notoriously slow for various reasons.
    If you are intending to do any non-trivial amount of work with this loop,
    it is important to understand its exact behavior described in the "Notes" section below.
</p>

<h2>Example</h2>
<p>
    This example removes all entities with a specific prefab ID when the tab is selected.
    A local variable is used to temporarily store the list of all relevant entities.
    If the list was directly connected to the loop without using the local variable,
    this node graph will not work as intended 
    because the <a href="?node=get_entities_with_specified_prefab_on_the_field" class="node query"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1"><use x="0" y="0" width="1" height="1" href="#query_icon"/></svg> Get Entities With Specified Prefab on the Field</a>
    node will be evaluated every iteration and the list will change.
    <img src="/mw_doc/image/set_local_variable_example.webp" alt="set local variable example" class="expandable_img" loading="lazy"/>
</p>

<h2>Notes</h2>
<ul>
    <li>
        Changing the type of Iteration List of Iteration Value will change the type of the other to match it.
    </li>
    <li>
        <span class="input_var"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1"><use x="0" y="0" width="1" height="1" href="#input_icon"/></svg> Iteration List</span> is evaluated before each iteration. 
        This list can be modified while the loop is running,
        and this can even change <span class="output_var"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1"><use x="0" y="0" width="1" height="1" href="#output_icon"/></svg> Iteration Value</span> during the same iteration.
        While we cannot be absolutely certain,
        the behavior seems to be described by the following Python-like pseudocode:
        <pre>
  i:int = 0
  while True:
      iteration_list:list = get_iteration_list()
      if i >= len(iteration_list):
          break

      # it evaluates the list every time iteration value is used
      def get_iteration_value() -> generic:
          return get_iteration_list()[i]
      loop_body(get_iteration_value)

      i += 1</pre>
        Because of its behavior, following optimizations may be necessary for your loop to run better:
        <ul>
          <li>
            In most cases, you will want to copy the input list into a local variable first.
            This will make sure that <span class="input_var"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1"><use x="0" y="0" width="1" height="1" href="#input_icon"/></svg> Iteration List</span> does not get evaluated every iteration, improving performance.
          </li>
          <li>
            If <span class="output_var"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1"><use x="0" y="0" width="1" height="1" href="#output_icon"/></svg> Iteration Value</span> is used multiple times, you will want to store it into a local variable first.
            This will make sure that <span class="input_var"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1"><use x="0" y="0" width="1" height="1" href="#input_icon"/></svg> Iteration List</span> does not get evaluated every time the output is used, improving performance.
          </li>
          <li>
            If you have a performance critical loop, you may want to use <a href="?node=finite_loop" class="node execution"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1"><use x="0" y="0" width="1" height="1" href="#execution_icon"/></svg> Finite Loop</a> instead and compare its performance.
          </li>
          <li>
            You may be interested to use <a class="outbound_link" href="https://act.hoyoverse.com/ys/prod/ugc/component-store/index.html#/item/1996190637174599680">Better List Iteration v2</a> composite nodes from the Resource Center,
            which deals with the local variables for input and output.
          </li>
        </ul>
    </li>
</ul>

<h2>Performance</h2>
<p>
    This node is unusually slow in load testing. 
    This is maybe because the debugger stores and/or serializes all the values it iterated through,
    but we are unsure how much faster it runs in release.
    Looping through a list of 10 integers took ~200 units on average. 
    Looping through a list of 1000 integers took ~4000 units on average.
</p>
<span class="small">
Performance may vary for various reasons.
These numbers are just for giving a sense of rough magnitude.
Performance may differ from profiling in a test play when playing a published stage.
First execution of a node within a node graph execution tend to take a bit longer.
</span>

<h2>See Also</h2>
<ul class="ul_no_dot see_also">
    <li>
        <a href="?node=break_loop" class="node execution"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1"><use x="0" y="0" width="1" height="1" href="#execution_icon"/></svg> Break Loop</a>
    </li>
    <li>
        <a href="?node=finite_loop" class="node execution"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1"><use x="0" y="0" width="1" height="1" href="#execution_icon"/></svg> Finite Loop</a>
    </li>
</ul>

<h2>Credits</h2>
    <p>Written by: kokokokomi222</p>
    <p>Last updated: 2026-02-21 (Luna IV)</p>
    <p><a href="https://github.com/kokokokomi222/mw_doc/commits/master/build/doc_written/L/list_iteration_loop.md">See Edit History</a></p>
    <p>Got improvement to this doc? <a class="outbound_link" href="https://forms.gle/SEe61aTg6L3Am65B9">Please submit it here.</a></p>
